(()=>{let e=(e,t,i)=>(...a)=>{try{e(...a)}catch(e){null==t||t(i||"Error in handler",e)}},t=e=>"V"===e,i=e=>o(e),a=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)?$/,n=e=>a.test(e),r=e=>n(e)?i(e):e,l=e=>n(e)?e:s(e),s=e=>btoa(unescape(encodeURIComponent(e))),o=e=>decodeURIComponent(escape(atob(e))),d=e=>e?e.split("&c=${AAX_PAYLOAD}").join(""):e;var c=function(e){console.debug(e)},m=function(e,t){console.error(e,JSON.stringify(t)),p("ERROR",e,u(e,t))},h=function(e,t){console.error(e,JSON.stringify(t)),p("FATAL",e,u(e,t))},p=function(e,t,i){var a;null==(a=window.ueLogError)||a.call(window,i,{logLevel:e,attribution:"APE-safeframe",message:t+" | "})},u=function(e,t){return t instanceof Error?t:t?Error(t):Error(e)};class g{constructor(e={},t={},i={}){this.adMap=e,this.ADS_HANDLERS=t,this.viewableLatencyTrackers=i}}class w{constructor(e){this.adMap=e,this.sendMessageToAd=(e,t,i)=>{this.adMap[e].messagePort.postMessage({command:t,data:i})},this.sendCustomMessageToAd=(e,t,i)=>{this.sendMessageToAd(e,"customMessage",{key:t,data:i})}}}function f(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},a=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(i).filter(function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),a.forEach(function(t){var a;a=i[t],t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a})}return e}class v{constructor(e,t){this.supportedCommands=e,this.eventsChannel=t,this.receiveMessage=async({data:{command:e,adDetails:t,payload:i}})=>{try{let a=f({},this.eventsChannel,this.supportedCommands)[e];a&&await a(t,i)}catch(e){m("Problem with message: "+JSON.stringify(i),e)}}}}let b=e=>e+"_Feedback";class y{async addSponsoredLabelWithFeedbackLink(e,t){e.appendChildTo(this.parentHtmlId,this);let i=await t.getSponsoredLabelAndFeedbackLink(this.urlPathAndParameter);if(!(null==i?void 0:i.isOk()))throw Error(`Result from the feedback service was not ok ${this.urlPathAndParameter}`);e.updateElement(this.getHtmlId(),i)}getHtmlId(){return b(this.parentHtmlId)}isHidden(){return this.hidden}exists(e){return e.exists(this.getHtmlId())}getFeedbackSpanElement(){return document.querySelector(`#${this.getHtmlId()} span`)}constructor(e,t,i,a,n,r,l){this.parentHtmlId=e,this.feedbackStyle=t,this.labelText=i,this.labelStyle=a,this.position=n,this.urlPathAndParameter=r,this.hidden=l}}class E{open(e){e.clickChildLink(this)}getHtmlId(){return b(this.parentHtmlId)}constructor(e){this.parentHtmlId=e}}class I{async createSponsoredLabelWithFeedbackLink(e,t){if(!e.exists(this.feedbackHtmlPort)){t.request();try{await e.addSponsoredLabelWithFeedbackLink(this.feedbackHtmlPort,this.feedbackApiPort),t.success(),e.isHidden()||t.labelRenderedHost()}catch(e){throw t.error(),e}}}openModal(e){e.open(this.feedbackHtmlPort)}labelRendered(e){e.labelRenderedCreative()}logTransparencyInfoMissing(e){e.transparencyInfoMissing()}constructor(e,t){this.feedbackHtmlPort=e,this.feedbackApiPort=t}}var x=/(\/b|\/s|\/l).*(node=)(\d{1,12})/,S=new Map,T=function(){if(!S.has(window.location.href)){var e=x.exec(window.location.href),t=e&&e[3]?e[3]:null;S.set(window.location.href,t)}return S.get(window.location.href)},A=function(e){var t=T();if(!e||!t)return null;var i=e.split(":");return i.splice(i.length-1,0,t),i.join(":")},C=function(e){var t=T();return t?"".concat(e,":").concat(t):null},M=function(e){return e.replace(/_/g,":")},k=function(e,t,i){if(void 0===i&&(i=1),R()){var a=function(e,t,i){t&&D("".concat(_(e),":").concat(t),i)};a(e,t.id,i),a(e,C(t.id),i),a(e,M(t.name),i),a(e,A(M(t.name)),i)}},N=function(e,t){void 0===t&&(t=1),R()&&D(_(e),t)},R=function(){var e;return"function"==typeof(null==(e=null==window?void 0:window.ue)?void 0:e.count)},D=function(e,t){var i;return null==(i=null==window?void 0:window.ue)?void 0:i.count(e,t)},O="adplacements",_=function(e){return e.startsWith(O)?e:"".concat(O,":").concat(e)},L=function(e){if(window.csa)try{window.csa("Events",{producerId:"adplacements"})("setEntity",{adCreativeMetaData:e})}catch(e){m("Error with 'setEntity' CSA",e)}},F=function(e,t,i){if(void 0===i&&(i=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e+":"+t.name+":"+t.id,metricValue:i},{ent:"all"})}catch(e){m("Error with 'logCsaEvent' CSA",e)}},B=function(e,t){if(void 0===t&&(t=1),window.csa)try{window.csa("Events",{producerId:"adplacements"})("log",{schemaId:"ApeSafeframe.csaEvent.1",metricName:e,metricValue:t},{ent:"all"})}catch(e){m("Error with 'incrementCounter' CSA",e)}};let H=e=>new V(e),z={REQUEST:"adfeedback_request",SUCCESS:"adfeedback_success",ERROR:"adfeedback_error",LABEL_RENDERED_CREATIVE:"adfeedback_sponsoredlabelrendered_creative",LABEL_RENDERED_HOST:"adfeedback_sponsoredlabelrendered_host"},U={REQUEST:"adfeedback:request",SUCCESS:"adfeedback:success",ERROR:"adfeedback:error",LABEL_RENDERED_CREATIVE:"adfeedback:sponsoredlabelrendered:creative",LABEL_RENDERED_HOST:"adfeedback:sponsoredlabelrendered:host",LABEL_RENDERED:"adfeedback:sponsoredlabelrendered",TRANSPARENCY_INFO_MISSING:"adfeedback:transparencyinfo:missing"};class V{request(){k(U.REQUEST,this.placement),N(U.REQUEST),F(z.REQUEST,this.placement)}success(){k(U.SUCCESS,this.placement),N(U.SUCCESS),F(z.SUCCESS,this.placement)}error(){k(U.ERROR,this.placement),F(z.ERROR,this.placement)}labelRenderedCreative(){k(U.LABEL_RENDERED_CREATIVE,this.placement),N(U.LABEL_RENDERED),F(z.LABEL_RENDERED_CREATIVE,this.placement)}labelRenderedHost(){k(U.LABEL_RENDERED_HOST,this.placement),N(U.LABEL_RENDERED),F(z.LABEL_RENDERED_HOST,this.placement)}transparencyInfoMissing(){k(U.TRANSPARENCY_INFO_MISSING,this.placement),N(U.TRANSPARENCY_INFO_MISSING)}constructor(e){this.placement=e}}class ${isOk(){return"ok"===this.status}constructor(e,t,i){this.status=e,this.html=t,this.script=i}}class W{async getSponsoredLabelAndFeedbackLink(e){let t=await window.fetch(this.windowRepo.origin()+e);if(t.ok){let e=await t.json();return new $(e.status,e.html,e.script)}throw Error("Could not fetch the feedback html/link/script/label")}constructor(e){this.windowRepo=e}}class J{appendChildTo(e,t){var i,a;function n(e,t){let i=document.createElement("div");return i.setAttribute("id",t.getHtmlId()),i.classList.add("ape-feedback"),i.style.position="relative",i.style.height="auto",i.style.minHeight="20px",i.style.textAlign=i.id.includes("hero-quick-promo_Desktop_placement_Feedback")?"left":"right",i.style.padding="0",i.style.marginTop="2px",i.style.display=t.feedbackStyle.display,e.endsWith("_wrapper")&&(e.includes("-ilm")||(i.style.maxWidth="min(100vh, 100vw)"),i.style.marginLeft="auto",i.style.marginRight="auto",i.style.padding="0 5px"),i.append(function(e){let t=document.createElement("div");return t.innerHTML=e.labelText,j(t,e.labelStyle),t}(t)),i}1===t.position?null==(i=document.getElementById(e))||i.prepend(n(e,t)):0===t.position&&(null==(a=document.getElementById(e))||a.append(n(e,t)))}updateElement(e,t){let i=document.getElementById(e);if(i)for(let e of(i.innerHTML=t.html,q(i,t),i.children))"DIV"===e.tagName?e.removeAttribute("style"):"A"===e.tagName&&(e.style.removeProperty("position"),e.style.removeProperty("top"),e.style.removeProperty("right"),e.style.removeProperty("display"))}clickChildLink(e){let t=document.getElementById(e.getHtmlId());for(let e of(null==t?void 0:t.children)||[]){var i;if("A"===(i=e).tagName||"DIV"===i.tagName)return void e.click()}}exists(e){return!!document.getElementById(e)}}let j=(e,t)=>{for(let i in t)e.style.setProperty(i,t[i])},q=(e,t)=>{G(e).innerHTML=t.script},G=e=>{let t=document.createElement("script");return e.prepend(t),t},X={code:"BE",hostname:"www.amazon.com.be",name:"Belgium"},Y={code:"FR",hostname:"www.amazon.fr",name:"France"},K={code:"DE",hostname:"www.amazon.de",name:"Germany"},Z={code:"IT",hostname:"www.amazon.it",name:"Italy"},Q={code:"NL",hostname:"www.amazon.nl",name:"Netherlands"},ee={code:"PL",hostname:"www.amazon.pl",name:"Poland"},et={code:"ES",hostname:"www.amazon.es",name:"Spain"},ei={code:"SE",hostname:"www.amazon.se",name:"Sweden"},ea=e=>location.hostname===e.hostname,en=()=>ea(X)||ea(Y)||ea(K)||ea(Z)||ea(Q)||ea(ee)||ea(et)||ea(ei),er=e=>!en()||el(e),el=e=>{var t,i,a,n,r,l;let s=[];eo(null==e||null==(a=e.url)||null==(i=a.parameters)||null==(t=i.adPlacementMetaData)?void 0:t.slotName)&&s.push("DSA Error: slotName missing");let o=null==e||null==(l=e.url)||null==(r=l.parameters)||null==(n=r.adCreativeMetaData)?void 0:n.adCreativeDetails;for(let e of((!o||o.length<=0)&&s.push("DSA Error: transparency info missing"),null==o||o.every(e=>es(e,s)),s))m(e);return s.length<=0},es=(e,t)=>{var i,a,n,r,l;e.version||t.push("DSA Error: version missing"),eo(e.advertiserIdNS)&&t.push("DSA Error: advertiserIdNS missing"),((null==(i=e.selectionSignals)?void 0:i.context)===void 0||(null==(a=e.selectionSignals)?void 0:a.context)===null)&&t.push("DSA Error: selectionSignals.context missing"),((null==(n=e.selectionSignals)?void 0:n.location)===void 0||(null==(r=e.selectionSignals)?void 0:r.location)===null)&&t.push("DSA Error: selectionSignals.location missing"),eo(null==(l=e.selectionSignals)?void 0:l.pastActivity)&&t.push("DSA Error: selectionSignals.pastActivity missing")},eo=e=>!(null==e?void 0:e.trim());class ed{constructor(e,t){this.weblabsWindow=e,this.prefix=t,this.isT1=()=>"t1"===this.weblabTreatment(),this.isT2=()=>"t2"===this.weblabTreatment(),this.isT3=()=>"t3"===this.weblabTreatment(),this.isT4=()=>"t4"===this.weblabTreatment(),this.isT5=()=>"t5"===this.weblabTreatment(),this.weblabTreatment=()=>{var e,t,i;return null==(i=this.weblabsWindow)||null==(t=i.renderingWeblabs)||null==(e=t[this.prefix])?void 0:e.toLowerCase()}}}let ec=()=>new ed(window,"A2I_HOMEPAGE_CARD_THEMING_360311"),em=()=>new ed(window,"ADPT_SF_LOW_RATE_METRIC_LOGGING_1256362"),eh=()=>new ed(window,"ADPT_SF_HIGH_RATE_METRIC_LOGGING_1256364"),ep=()=>new ed(window,"ADPT_SF_SERVER_SIDE_SPONSORED_LABEL_998980"),eu=()=>new ed(window,"APM_STORES_JPS_JRS_SAFEFRAME_UX_ELEMENT_OBSTRUCTION_DETECTION_1220127"),eg=()=>new ed(window,"APM_STORES_JPS_JRS_SAFEFRAME_VIEW_OBSTRUCTIONS_1226495"),ew=()=>new ed(window,"APM_STORES_JPS_JRS_SAFEFRAME_SERVER_SIDE_CREATIVE_SIZING_1230792"),ef=()=>new ed(window,"APM_STORES_JPS_JRS_SAFEFRAME_OBSTRUCTIONS_1237329"),ev=()=>new ed(window,"APM_STORES_JPS_JRS_SAFEFRAME_SIZING_1238561"),eb=()=>new ey(new I(new J,new W({origin:()=>window.location.origin})));class ey{async addSponsoredLabel({parentHtmlId:e,placement:t,feedback:i}){return!!ep().isT1()||(er(i)?(i.hidden&&(Object.assign(i.style,{display:"none"}),Object.assign(i.label.style,{display:"none"})),await this.feedbackService.createSponsoredLabelWithFeedbackLink(eI(e,i),H(t)),!0):(this.feedbackService.logTransparencyInfoMissing(H(t)),m("Transparency Information missing"),!1))}openModal(e){this.feedbackService.openModal(new E(e))}labelRendered({placement:e}){this.feedbackService.labelRendered(H(e))}constructor(e){this.feedbackService=e}}let eE=e=>"/af/feedback-link?pl="+e,eI=(e,t)=>{let i=JSON.parse(JSON.stringify(t.url.parameters));return i.adPlacementMetaData.pageUrl=l(i.adPlacementMetaData.pageUrl),new y(e,t.style,t.label.text,t.label.style,+("TOP"===t.position),eE(encodeURIComponent(JSON.stringify(i))),t.hidden)},ex=e=>{eb().labelRendered({placement:{id:e.placementId,name:e.placementName}})},eP=e=>{var t;eb().openModal(null!=(t=e.adUnitWrapperId)?t:e.adUnitPlacementId)},eS=async e=>{if(!await eb().addSponsoredLabel(eT(e)))throw Error("Failed to create sponsored label and feedback link")},eT=e=>{var t;let i=e.adPlacementMetaData,a=e.adFeedbackInfo;return{parentHtmlId:null!=(t=e.adUnitWrapperId)?t:e.adUnitPlacementId,placement:{id:e.placementId,name:e.placementName},feedback:{position:"BOTTOM",hidden:!a.boolFeedback,style:e.feedbackDivStyle,url:{parameters:{adPlacementMetaData:{adElementId:i.adElementId,pageType:i.pageType,pageUrl:l(i.pageUrl),slotName:i.slotName},adCreativeMetaData:e.adCreativeMetaData}},label:{text:r(a.sponsoredText),style:e.advertisementStyle}}}},eA={DESKTOP:16,MSHOP:10,MWEB:10},eC=e=>(null==e?void 0:e.length)>1&&"%"===e.charAt(e.length-1),eM=e=>eC(e)?e:`${parseInt(e)}px`,ek=(e,t="MWEB")=>{if(eC(e))return e;let i=parseFloat(e),a=eA[t];return i&&a?`${i/a}lh`:"inherit"},eN=(e,t)=>{let i=new Set(["bf4ab3db-618a-4853-ae89-3ad3bd17df16","dd4c5e61-fe9a-4d91-9deb-25fa60557719","da326e4a-90bd-4da3-a526-53301eb2c6a0","ca609359-3cb9-4984-8830-231c22e978d3","15554fd8-4c3e-45c6-ae61-84c65966f5d1","1396c5b8-45a1-4618-9a09-0b84209807f9","d9fb239d-fcde-414f-98a8-409c81052388","b60ea84b-3e24-44dc-9fdb-35bb2fb1fe5c","75b4c7aa-4c22-49d3-8371-15ca116eaf1f","ef368293-2611-4cef-8050-4fcd9b97f12e","db5cbac6-5194-4b52-9929-9ec0bbfed990","6479c6f3-a9c2-4d7c-9d1a-45008113fe0c"]);ec().isT1()&&i.has(e)&&(t&&(t.style.background="#FAE859"),t&&(t.style.margin="0px"))},eR="nav-ewc-persistent-hover",eD=e=>{eY(e.slotName)&&(ew().isT1()||eL(document.getElementById(e.adUnitPlacementId)))},eO=()=>null!==document.querySelector(`.${eR}`),e_=e=>"attributes"===e.type&&"class"===e.attributeName&&e.target.classList.contains(eR),eL=e=>{if(eO())return void eF(e);new MutationObserver((t,i)=>{if(t.some(e_))try{eF(e),i.disconnect()}catch(e){m("Failed to resize ILM for EWC.",e)}}).observe(window.document.documentElement,{attributes:!0,attributeFilter:["class"]})},eF=e=>{let t=document.querySelector("div#nav-flyout-ewc");if(null===e||null===t)return void m(`could not find placementDiv (value was: ${e}) or ewc (value was: ${t})`);eB(e,t.offsetWidth)},eB=(e,t)=>{var i,a;let n=document.createElement("style");n.innerHTML=`@media screen and (min-width: 1500px) { div[id$=${e.id}] {
        width: calc(100vw - ${t+5}px) !important;
        margin-left: calc(-50vw + 50% + ${t/2}px) !important;
        margin-right: calc(-50vw + 50% + ${t/2}px) !important;
    `,null==(a=document)||null==(i=a.body)||i.appendChild(n)},eH=["alm-morrisons-storefront-desktop-ad-1","alm-morrisons-storefront-desktop-ad-2","alm-monoprix-storefront-desktop-ad-1","alm-monoprix-storefront-desktop-ad-2","alm-dia-storefront-desktop-ad-1","alm-dia-storefront-desktop-ad-2","alm-storefront-desktop-ad-1","alm-storefront-desktop-ad-2","alm-wfm-storefront-desktop-ad-1","alm-wfm-storefront-desktop-ad-2"],ez="aUAZqFtiIp6VxqpW3coqZ2JdZnV3RN9S8yKMRIdJ",eU=(e,t,i)=>{eh().isT1()&&e$(eW(e,i,function(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):(function(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);i.push.apply(i,a)}return i})(Object(t)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(t,i))}),e}(f({},eJ(t)),{creativeId:t.adCreativeMetaData.adCreativeId})))},eV=(e,t,i)=>{em().isT1()&&e$(eW(e,i,eJ(t)))},e$=e=>{navigator.sendBeacon(`https://e5qq6zj76g.execute-api.us-east-1.amazonaws.com/metric?x-api-key=${ez}`,JSON.stringify(e))},eW=(e,t,i)=>({metricName:e,timestamp:new Date().getTime(),count:t,dimensions:i,xApiKey:ez}),eJ=e=>{var t,i;return{app:"SF",siteName:e.siteName,slotName:e.slotName,pageType:e.pageType,placementId:e.placementId,mediaType:e.mediaType,programId:null==(t=e.adCreativeMetaData)?void 0:t.adProgramId,creativeTemplateName:null==(i=e.adCreativeMetaData)?void 0:i.adCreativeTemplateName,deviceType:e.deviceType}},ej=["desktop-detail-ilm","vindp-desktop-atf-ilm","fresh-desktop-detail-ilm","wfm-desktop-detail-ilm","alm-weis-desktop-detail-ilm","alm-save-desktop-detail-ilm","alm-lucky-desktop-detail-ilm","alm-bristol-desktop-detail-ilm","alm-rite-desktop-detail-ilm","alm-bartell-desktop-detail-ilm","alm-cardenas-desktop-detail-ilm","alm-petfoodexpress-desktop-detail-ilm","alm-allthebestpetcare-desktop-detail-ilm"],eq=["mobile-detail-ilm","mobile-app-detail-ilm","fresh-mobile-detail-ilm","fresh-mobile-detail-ilm-v1","wfm-mobile-detail-ilm-v1"],eG=["asr-indie-manga-banner","asr-indie-fliptoon-banner","asr-managed-fliptoon-banner","fresh-ad-left","fresh-ad-left-2","alm-wfm-fresh-ad-left","wfm-ad-left-2","alm-monoprix-fresh-ad-left","alm-monoprix-ad-left-2","alm-morrisons-fresh-ad-left","alm-morrisons-ad-left-2","alm-dia-fresh-ad-left","alm-dia-ad-left-2","alm-weis-ad-left","alm-weis-ad-left-2","alm-save-ad-left","alm-save-ad-left-2","alm-lucky-ad-left","alm-lucky-ad-left-2","alm-bristol-ad-left","alm-bristol-ad-left-2","alm-rite-ad-left","alm-rite-ad-left-2","alm-bartell-ad-left","alm-bartell-ad-left-2","alm-cardenas-ad-left","alm-cardenas-ad-left-2","alm-petfoodexpress-ad-left","alm-petfoodexpress-ad-left-2","alm-allthebestpetcare-ad-left","alm-allthebestpetcare-ad-left-2","alm-coop-ad-left","alm-coop-ad-left-2","alm-pampanorama-ad-left","alm-pampanorama-ad-left-2","alm-iceland-ad-left","alm-iceland-ad-left-2","alm-arcs-ad-left","alm-arcs-ad-left-2","alm-seijoishii-ad-left","alm-seijoishii-ad-left-2","alm-life-ad-left","alm-life-ad-left-2","alm-tegut-ad-left","alm-tegut-ad-left-2","merchandised-search-top-1","merchandised-search-7","auto-left-advertising-1","auto-left-advertising-2","gwm-atf-dashboard"];class eX{resize(e){var t;if(!this.isAllowedSize(e))return m(`Size w:'${e.width}', h:'${e.height}' is not allow-listed for '${this.name}'`),!1;let i=this.wrapperDiv,a=this.div,n=this.safeframe;return null==i||i.removeAttribute("style"),i&&(i.style.overflow="hidden"),i&&(i.style.backgroundColor="white"),a.removeAttribute("style"),a.style.lineHeight=i?"1rem":"0",i||(a.style.marginBottom="20px"),a.style.marginLeft="auto",a.style.marginRight="auto",a.style.maxHeight="inherit",a.style.maxWidth=i?"min(100vh, 100vw, 100%)":"inherit",a.style.position="relative",n.style.height="100%",n.style.width="100%",n.removeAttribute("height"),n.removeAttribute("width"),n.style.removeProperty("min-width"),n.style.removeProperty("max-height"),n.style.removeProperty("padding-bottom"),null==(t=this.card)||t.style.setProperty("padding","0"),eC(e.height)||eC(e.width)||ev().isT1()&&"FIXED"===this.sizing?(a.style.width=eM(e.width),a.style.height=i?ek(e.height):eM(e.height)):(a.style.aspectRatio=`${parseInt(e.width)} / ${parseInt(e.height)}`,i&&(a.style.minHeight=ek(e.height))),this.resizeHandleSpecialCases(e),eN(this.id,this.wrapperDiv),!0}collapse(e){this.wrapperDiv&&(this.wrapperDiv.style.display="none"),this.div.style.display="none",eU("placement:collapse",e)}resizeHandleSpecialCases(e){let t=this.div;if(eZ(this.slotName,e)){if(ev().isT1())return;t.style.maxWidth=eM(e.width)}else if(eK(this.slotName)){var i;if(ew().isT1())return;let e=this.wrapperDiv;null==e||e.style.setProperty("width","100vw"),null==e||e.style.setProperty("margin-left","calc(-50vw + 50%)"),null==e||e.style.setProperty("margin-right","calc(-50vw + 50%)"),t.style.removeProperty("aspect-ratio"),t.style.removeProperty("max-width"),t.style.height=ek("50px"),null==(i=t.closest(".a-container"))||i.style.setProperty("padding-top","0")}else if(eY(this.slotName)){if(ew().isT1())return;t.style.removeProperty("aspect-ratio"),t.style.removeProperty("max-width"),t.style.height="55px",t.style.width="100vw",t.style.marginLeft="calc(-50vw + 50%)",t.style.marginRight="calc(-50vw + 50%)",eO()&&(t.style.width="100%",t.style.removeProperty("margin-left"),t.style.removeProperty("margin-right"));let e=document.createElement("style");e.innerHTML=`@media screen and (max-width: 1000px) {div[id$=${this.div.id}] { width: 100% !important; margin-left: 0 !important; margin-right: 0 !important; }}`,this.div.prepend(e);let i=document.createElement("style");i.innerHTML=`#${t.id}_Feedback { margin-right: 10px; }`,t.prepend(i)}else if(eH.includes(this.slotName)){if(ew().isT1())return;this.div.style.maxWidth="300px",this.div.style.marginTop="47px",this.div.style.removeProperty("margin-left"),this.div.style.removeProperty("margin-right")}else if("hero-quick-promo"===this.slotName||"fresh-hero-quick-promo"===this.slotName||"wfm-hero-quick-promo"===this.slotName){if(ew().isT1())return;this.div.style.maxWidth="650px",this.div.style.removeProperty("margin-left"),this.div.style.removeProperty("margin-right")}}get wrapperDiv(){return this.wrapperDivId?document.getElementById(this.wrapperDivId):null}get div(){return document.getElementById(this.divId)}get safeframe(){return document.getElementById(this.safeframeId)}get card(){return document.getElementById(`ape_${this.name}_aui_card`)}constructor(e,t,i,a,n,r,l,s){this.id=e,this.name=t,this.wrapperDivId=i,this.divId=a,this.safeframeId=n,this.slotName=r,this.allowedSizes=l,this.sizing=s,this.isAllowedSize=e=>this.allowedSizes.some(t=>eM(e.height)===t.height&&eM(e.width)===t.width)}}let eY=e=>ej.includes(e),eK=e=>eq.includes(e),eZ=(e,t)=>970===parseInt(t.width)||980===parseInt(t.width)||728===parseInt(t.width)||eG.includes(e),eQ=e=>e0(e,[]),e0=(e,t)=>{var i;return new eX(e.placementId,e.placementName,e.adUnitWrapperId,e.adUnitPlacementId,e.adUnitIframeId,e.slotName,(null!=(i=e.allowedSizes)?i:[]).concat({height:eM(e.size.height),width:eM(e.size.width)}).concat(t.map(e=>({height:eM(e.height),width:eM(e.width)}))),e.sizing)},e1=[{p:50,t:2,def:"iab"}],e2=[{p:0,t:0,def:"amzn"},{p:50,t:1,def:"iab"},{p:100,t:1,def:"groupm"}],e5=[{p:0,t:0,def:"amzn"},{p:30,t:1,def:"iab"},{p:100,t:1,def:"groupm"}],e3=()=>window.innerHeight||document.documentElement.clientHeight,e9=()=>window.innerWidth||document.documentElement.clientWidth,e4=e=>e.getBoundingClientRect().top-e3(),e6=(e,t)=>({t:e.top,l:e.left,r:e.right,b:e.bottom,w:e.width,h:e.height,z:t}),e8=e=>e6(e.getBoundingClientRect(),Number(window.getComputedStyle(e,null).zIndex)),e7=e=>tt(e8(e)),te=e=>tt(e6(e,NaN)),tt=e=>{let t=tl(e);return{t:e.t,l:e.l,r:e.r,b:e.b,w:e.w,h:e.h,z:e.z,xiv:t.xiv,yiv:t.yiv,iv:t.iv}},ti=()=>{let e=window.screenY?window.screenY:window.screenTop,t=window.screenX?window.screenX:window.screenLeft,i=e9(),a=e3();return{t:e,l:t,w:i,h:a,b:e+a,r:t+i}},ta=e=>{let t=ti(),i=e7(e),a=ts(e);return{atf:tn(e),geom:{win:t,self:i,exp:a},payload:{wh:t.h,ww:t.w,sx:window.scrollX,sy:window.scrollY,ah:i.h,aw:i.w,top:i.t,left:i.l}}},tn=e=>{let t=function(e){let t=document.body.getBoundingClientRect();if(tr(t))return null;let i=e8(e),a=e3(),n=e9();return Number(Math.min(1,Math.max(0,Math.max(0,Math.min(t.left+n,i.r)-i.l)*Math.max(0,Math.min(t.top+a,i.b)-i.t)/(i.h*Math.min(i.w,n)))).toFixed(2))}(e);return null==t?"unknown":t>=.5},tr=e=>0===e.width&&0===e.height,tl=e=>{let t=e9(),i=e3(),a=Math.max(0,tc(e.t,e.b,i)),n=Math.max(0,tc(e.l,e.r,t)),r=a*n,l=e.h*Math.min(e.w,t);return 0!==l||0!==r?{xiv:Number(Math.min(1,n/e.w).toFixed(2)),yiv:Number(Math.min(1,a/e.h).toFixed(2)),iv:Number(Math.min(1,Math.max(0,r/l)).toFixed(2))}:{xiv:0,yiv:0,iv:0}},ts=e=>to(e.getBoundingClientRect()),to=e=>({t:e.top,l:e.left,r:e9()-e.right,b:e3()-e.bottom,xs:+(Math.max(document.body.scrollWidth,document.documentElement.scrollWidth)>e9()),yx:+(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)>e3())}),td=e=>to(e),tc=(e,t,i)=>{let a=0;return"visible"!==document.visibilityState?a:Math.min(a=e>0?i-e:t>0?Math.min(t,i):0,t-e)},tm=(e,t)=>{let i=e8(e),a=e8(t),n=e9(),r=e3();return i&&a&&(Math.abs(i.t-a.b)<r||Math.abs(i.b-a.t)<r)&&(Math.abs(i.l-a.r)<n||Math.abs(i.r-a.l)<n)},th=e=>{let t=parseInt(e.size.height)*parseInt(e.size.width)>=242500;return"V"===e.mediaType?e1:t?e5:e2};function tp(e,t,i){var a,n=i||{},r=n.noTrailing,l=void 0!==r&&r,s=n.noLeading,o=void 0!==s&&s,d=n.debounceMode,c=void 0===d?void 0:d,m=!1,h=0;function p(){a&&clearTimeout(a)}function u(){for(var i=arguments.length,n=Array(i),r=0;r<i;r++)n[r]=arguments[r];var s=this,d=Date.now()-h;function u(){h=Date.now(),t.apply(s,n)}function g(){a=void 0}!m&&(o||!c||a||u(),p(),void 0===c&&d>e?o?(h=Date.now(),l||(a=setTimeout(c?g:u,e))):u():!0!==l&&(a=setTimeout(c?g:u,void 0===c?e-d:e)))}return u.cancel=function(e){var t=(e||{}).upcomingOnly;p(),m=!(void 0!==t&&t)},u}let tu=e=>{window.addEventListener("scroll",e),window.addEventListener("resize",e),document.addEventListener("visibilitychange",e)},tg=e=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e),document.removeEventListener("visibilitychange",e)};var tw={wb:"ues",bb:"uet",af:"uet",cf:"uet",be:"uet",ld:"uex"},tf=function(e){var t,i,a=e.latencyEvent,n=e.scope,r=e.placement,l=e.timestamp;tv(a)&&(tb(a,ty(n),r.id,l),tb(a,ty(n),M(r.name),l),tb(a,ty(n),null!=(t=A(r.name))?t:void 0,l),tb(a,ty(n),null!=(i=C(r.id))?i:void 0,l))},tv=function(e){return"function"==typeof window[tw[e]]},tb=function(e,t,i,a){void 0===a&&(a=new Date);var n=tw[e];i&&"function"==typeof window[n]&&window[n](e,t+i,{wb:1},a)},ty=function(e){return"adplacements:"+tE(e)},tE=function(e){return e?"".concat(e,":"):""},tI=function(e,t,i){if(window.csa)try{window.csa("Content",{element:e})("mark",t,null==i?void 0:i.getTime())}catch(e){m("Error with 'mark' CSA",e)}};class tx{sendLatencyMetric({latencyMetricType:e,placementId:t,placementName:i,placementDivId:a,timestamp:n}){tf({latencyEvent:e.csmKey,scope:e.csmMessage,placement:{id:t,name:i},timestamp:n}),tI(document.getElementById(a),e.csaKey,n)}}let tP=()=>new tx,tS="sfImpression",tT="LightAdImpression",tA="viewablelatency",tC=(e,t,i)=>({csaKey:e,csmKey:t,csmMessage:i}),tM=tC("bodyBegin","bb"),tk=tC("bodyBegin","bb",tS);tC("bodyBegin","bb",tT),tC("bodyEnd","be"),tC("clickToATF","af"),tC("criticalFeature","cf"),tC("criticalFeature","cf",tS),tC("criticalFeature","cf",tT),tC("loaded","ld"),tC("loaded","ld",tS),tC("loaded","ld",tT);let tN=tC("viewablelatency:bodyBegin","bb",tA),tR=tC("viewablelatency:loaded","ld",tA),tD=(e,t,i)=>e>0?i>e:t>0,tO=(e,t,i,a,n,r)=>{var l,s,o;let d=null==(o=document)||null==(s=o.getElementById)||null==(l=s.call(o,i))?void 0:l.getBoundingClientRect();if(d&&tD(d.top,d.bottom,e3())&&tD(d.left,d.right,e9())){if(tP().sendLatencyMetric({latencyMetricType:tN,placementId:n,placementName:a,placementDivId:i,timestamp:new Date}),e[r].loaded){tP().sendLatencyMetric({latencyMetricType:tR,placementId:n,placementName:a,placementDivId:i,timestamp:new Date});let e={id:n,name:a};k("adplacements:htmlviewed:loaded:",e),k("adplacements:htmlviewed",e)}t.viewed=!0,tg(t.tracker)}},t_=(t,i)=>{if(!t[i.arid]){t[i.arid]={valid:!1};try{let a=t[i.arid];tO(t,a,i.adUnitPlacementId,i.placementName,i.placementId,i.arid);let n=e(tp(20,()=>{tO(t,a,i.adUnitPlacementId,i.placementName,i.placementId,i.arid)}),m);tu(n),a.tracker=n,a.valid=!0}catch(e){throw m("Error initializing viewable latency instrumentation",e),e}}},tL=e=>{try{k("coordinate:x",e,e.div.getBoundingClientRect().x),k("coordinate:y",e,e.div.getBoundingClientRect().y)}catch(e){return}},tF=e=>{N("resize:size:request"),tB(e)&&("100%"===e.size.width||"100%"===e.size.height?eV("resize:size:differresponsive",e):eV("resize:size:differfixed",e),N("resize:size:differ")),tH(e)||eV("creativesize:slotsizediffer",e)},tB=e=>{let t=(e,t)=>"100%"===e?0!==t:parseInt(e)!==t;return t(e.size.width,e.creative.size.width)||t(e.size.height,e.creative.size.height)},tH=e=>{let t=e.creative.size;return!t||0===t.width||0===t.height||e.slotSizes.some(e=>e.width===t.width&&e.height===t.height)},tz=(e,t)=>{let i=e=>eC(e)?e:parseInt(e),a=i(t.height),n=i(t.width);eV(`creative:size:changeSize:${n}x${a}`,e)},tU=(e,t,i)=>{tP().sendLatencyMetric({latencyMetricType:tk,placementId:e.placementId,placementName:e.placementName,placementDivId:e.adUnitPlacementId}),i&&(tP().sendLatencyMetric({latencyMetricType:tM,placementId:e.placementId,placementName:e.placementName,placementDivId:e.adUnitPlacementId,timestamp:i}),tf({latencyEvent:"wb",placement:t,timestamp:i})),k("adload:start",t),F("adload_start",t),k("adload:delayloadcallback",t),F("adload_delayload",t)};class tV{constructor(e,t){this.hc=e,this.hmr=t,this.initializeAdMap=(e,t)=>{try{this.hc.adMap[e.arid]={messagePort:t}}catch(t){m(`Error creating safeFrame ${e.slotName}`,t)}},this.secondPhaseLoadAd=async(e,t,i,a)=>{await this.setupMessageChannel(i,t,a)},this.setupMessageChannel=async(e,t,i)=>{var a,n;null==(n=performance)||null==(a=n.mark)||a.call(n,`SafeFrame: Start setupMessagePort ${t.adUnitPlacementId}`),this.initializeAdMap(t,e);let r=this.hc;r.ADS_HANDLERS[t.arid]=r.ADS_HANDLERS[t.arid]||{};let l=eQ(t);l.resize(t.size),tF(t),tL(l),tU(t,l,i),t_(r.viewableLatencyTrackers,t);try{await eS(t),t$(r,t,this.hmr),tW(t)}catch(e){throw l.collapse(t),e}}}}let t$=(e,t,i)=>{e.adMap[t.arid].messagePort.onmessage=i.receiveMessage},tW=e=>{eD(e)},tJ=e=>({initialBoundingRect:e.getBoundingClientRect(),adHeight:e.offsetHeight,adWidth:e.offsetWidth,originalScrollX:window.scrollX,originalScrollY:window.scrollY}),tj=e=>{let t=tq(e),i=ti(),a=te(t);return{atf:"unknown",geom:{win:i,self:a,exp:td(t)},payload:{wh:i.h,ww:i.w,sx:window.scrollX,sy:window.scrollY,ah:a.h,aw:a.w,top:a.t,left:a.l}}},tq=e=>{let t=e.initialBoundingRect,i=t.top-(window.scrollY-e.originalScrollY),a=i+e.adHeight,n=t.left-(window.scrollX-e.originalScrollX),r=n+e.adWidth;return{top:i,bottom:a,left:n,right:r,width:e.adWidth,height:e.adHeight}},tG="btr_client",tX="cod_client",tY=async(e,t)=>{if(e&&e.trim().match(/^\d{1,4}px$/g))return await tK(parseInt(e,10),t,(e,t)=>{let i=e4(e);return e&&i<=t})},tK=async(t,i,a)=>new Promise(n=>{let r=()=>{a(i,t)&&(n(),window.removeEventListener("scroll",l),window.removeEventListener("resize",l))},l=e(tp(20,()=>{r()}),m);window.addEventListener("scroll",l),window.addEventListener("resize",l),r()}),tZ=(e,t,i,a,n,r)=>{let l=null==e?void 0:e[t];(null==l?void 0:l.valid)&&(l.loaded=!0,l.viewed&&(tP().sendLatencyMetric({latencyMetricType:tR,placementId:a,placementName:i,placementDivId:n,timestamp:new Date(r)}),k("htmlviewed:loaded",{id:a,name:i})))},tQ=async(e,t)=>{let i,a;return new Promise(n=>{a=n,(i=new IntersectionObserver(t=>{t.forEach(t=>{t.target===e&&t.isIntersecting&&(a(t),i.unobserve(e))})},t)).observe(e)})},t0=e=>{let t=document.getElementById(e.adUnitIframeId);return t||(N("getiframe:undefined"),eV("html:element:missing:iframe",e)),t},t1=async e=>{let t=t0(e),i={root:t2(t)?null:document.documentElement};await tQ(t,i)},t2=e=>{let t=e;for(;t;){if("fixed"===window.getComputedStyle(t,null).getPropertyValue("position"))return!0;t=t.parentElement}return!1},t5=e=>{let t=document.getElementById(e.adUnitPlacementId);return t||(N("getplacement:undefined"),eV("html:element:missing:placement",e)),t},t3=async(e,t)=>{eV("debug:pixel:cod:prehost",t),t.firePixelsAfter&&await tY(t.firePixelsAfter,t5(t)),await t1(t),eV("debug:pixel:cod:host",t),e.sendMessageToAd(t.arid,"fireImpression",{measurementMethod:tX,isNoInventory:!1})},t9=(e,t,i)=>{t6(e,i);let a=t.ADS_HANDLERS[i.arid];a.viewabilityTracker=()=>{tp(50,t6)(e,i)},tu(a.viewabilityTracker),new IntersectionObserver(()=>{t6(e,i)},{threshold:[0,.5,1]}).observe(t5(i))},t4=(e,t,i)=>{let a=t7(i);t8(e,i,a),e.sendMessageToAd(i.arid,"collapseSlot",{});let n=t.ADS_HANDLERS[i.arid];n.noInventoryViewabilityTracker=()=>{tp(20,t8)(e,i,a)},tu(n.noInventoryViewabilityTracker)},t6=(e,t)=>{let i=t0(t),a=th(t);if(i){let n=ta(i);n.viewabilityStandards=a,e.sendMessageToAd(t.arid,"updateViewability",n)}},t8=(e,t,i)=>{let a=th(t),n=tj(i);n.viewabilityStandards=a,e.sendMessageToAd(t.arid,"updateViewability",n)},t7=e=>tJ(t0(e)),ie=(e,t,i)=>{if(""===t)throw Error("Invalid queryParamKey input to addJSONQueryParamToURL: "+JSON.stringify({queryParamKey:t}));let a=new URL(e),n=Object.assign(JSON.parse(a.searchParams.get(t)||"{}"),i);return a.searchParams.set(t,JSON.stringify(n)),a.toString()},it=({abpAcceptable:e="false",abpStatus:t="-1"})=>"true"===e&&("1"===t||"-1"===t);class ii{async fire(e){this.isFired||(await fetch(this.pixelUrl(this.url,e),{keepalive:!0,mode:"no-cors"}),e.div.appendChild(this.pixel(e)),this.isFired=!0,this.logOnFirePixel(this.loggingContext,e))}logOnFirePixel(e,t){N(`pixel:${this.logId}`),k(`pixel:${this.logId}`,t),N(`pixel:${this.logId}:${e.aaxProgramId}`)}constructor(e,t,i,a){this.url=e,this.loggingContext=a,this.isFired=!1,this.pixel=e=>{let t=document.createElement("img");return t.id=`${this.pixelId}_${e.name}`,t.style.display="none",t.setAttribute("pixel-url",this.pixelUrl(this.url,e)),t},this.shouldAppendABPTag=it({abpAcceptable:t,abpStatus:i})}}class ia extends ii{constructor(e,t,i,a){super(e,t,i,a),this.pixelId="ape_impression",this.logId="imp:cod",this.pixelUrl=(e,t)=>ie(e,"pj",this.pixelUrlParameters(t)),this.pixelUrlParameters=e=>({measurementMethod:tX,ape_al:!!this.shouldAppendABPTag||void 0})}}class ir extends ii{constructor(e,t,i,a){super(e,t,i,a),this.pixelId="ape_measurability",this.logId="imp:atf",this.pixelUrl=(e,t)=>`${e.replace(/\/$/,"")}/atf/${JSON.stringify(this.pixelUrlParameters(t))}`,this.pixelUrlParameters=e=>({atf:tn(e.div),ape_al:!!this.shouldAppendABPTag||void 0})}}class il extends ii{fireInObserver(e,t){var i,a;this.fire(t),e.unobserve(t.div),null==(i=this.viewabilityService)||i.emitObstructionRecoveryMetrics(t),null==(a=this.viewabilityService)||a.removeNativeObstructionsChangedListener(),this.removeVisibilityChangeDetection()}restartInViewTimer(e,t){clearTimeout(this.timeoutId),this.timeoutId=setTimeout(()=>this.checkOcclusionsAndFire(e,t),this.thresholdTimeVisibleMs),this.setupVisibilityChangeDetection(this.timeoutId,e,t)}checkOcclusionsAndFire(e,t){try{var i;(null==(i=this.viewabilityService)?void 0:i.isViewabilityObstructed(t,this.thresholdPercentage))?this.restartInViewTimer(e,t):this.fireInObserver(e,t)}catch(i){h(i),this.fireInObserver(e,t)}}track(e){new IntersectionObserver((t,i)=>{t.forEach(t=>{t.isIntersecting?this.thresholdTimeVisibleMs>0?(this.timeoutId=setTimeout(()=>this.checkOcclusionsAndFire(i,e),this.thresholdTimeVisibleMs),this.setupVisibilityChangeDetection(this.timeoutId,i,e)):this.fireInObserver(i,e):(clearTimeout(this.timeoutId),clearInterval(this.shouldFirePixelIntervalId),this.removeVisibilityChangeDetection())})},{threshold:this.thresholdPercentage}).observe(e.div)}removeVisibilityChangeDetection(){this.visibilityChangeHandler&&(document.removeEventListener("visibilitychange",this.visibilityChangeHandler),this.visibilityChangeHandler=null)}setupVisibilityChangeDetection(e,t,i){this.removeVisibilityChangeDetection(),this.visibilityChangeHandler=()=>is(e,t,i),document.addEventListener("visibilitychange",this.visibilityChangeHandler)}async fire(e){return this.firePixelValidators.every(e=>e.shouldFirePixel())||await this.waitUntilShouldFirePixel(),super.fire(e)}waitUntilShouldFirePixel(){return new Promise(e=>{this.shouldFirePixelIntervalId=setInterval(()=>{this.firePixelValidators.every(e=>e.shouldFirePixel())&&(clearInterval(this.shouldFirePixelIntervalId),e())},100)})}get pixelId(){return`ape_viewability_${this.definition}`}set isBtr(e){this._isBtr=e}constructor(e,t,i,a,n,r,l,s=[],o){super(e,t,i,a),this.thresholdPercentage=n,this.thresholdTimeVisibleMs=r,this.definition=l,this.firePixelValidators=s,this.viewabilityService=o,this.visibilityChangeHandler=null,this._isBtr=!1,this.adStartTime=new Date().getTime(),this.pixelUrl=(e,t)=>`${e.replace(/\/+$/,"")}/v/${JSON.stringify(this.pixelUrlParameters(t))}`,this.pixelUrlParameters=e=>{var t;return{ape_al:!!this.shouldAppendABPTag||void 0,v:{def:this.definition,p:this.thresholdPercentage,t:this.thresholdTimeVisibleMs,ib:this._isBtr},wh:window.innerHeight||document.documentElement.clientHeight,ww:window.innerWidth||document.documentElement.clientWidth,sx:window.scrollX,sy:window.scrollY,ah:e.div.getBoundingClientRect().height,aw:e.div.getBoundingClientRect().width,top:e.div.getBoundingClientRect().top,left:e.div.getBoundingClientRect().left,ptv:(new Date().getTime()-(null!=(t=window.aPageStart)?t:0))/1e3,ttv:(new Date().getTime()-this.adStartTime)/1e3}},this.logId=`view:${this.definition}`}}let is=(e,t,i)=>{document.hidden?(clearTimeout(e),t.unobserve(i.div)):t.observe(i.div)},io="AppAdsMshopIOSPlugin",id=e=>{var t;null==(t=window.P)||t.when(io).execute(t=>{t.startAttributeViewThroughAppAds({skAdNetwork:e})})},ic=e=>{var t;null==(t=window.P)||t.when(io).execute(t=>{t.endAttributeViewThroughAppAds({skAdNetwork:e})})};class im extends ia{async fire(e){this.isFired||(id(this.skAdNetwork),this.isFired=!0,this.logOnFirePixel(this.loggingContext,e))}constructor(e,t,i,a,n){super(e,t,i,a),this.skAdNetwork=n,this.logId="imp:skan"}}class ih extends il{get pixelId(){return"skan_view_pixel"}async fire(e){this.isFired||(ic(this.skAdNetwork),this.isFired=!0,this.logOnFirePixel(this.loggingContext,e))}constructor(e,t,i,a,n){super(e,t,i,a,.5,2e3,""),this.skAdNetwork=n,this.logId="view:skan",this.pixelUrl=()=>{throw Error("PixelUrl should not be use for SkanViewPixel")}}}class ip extends ia{constructor(e,t,i,a){super(e,t,i,a),this.pixelId="ape_btr_impression",this.logId="imp:btr",this.pixelUrl=(e,t)=>ie(d(e),"c",{measurementMethod:tG})}}let iu=e=>{let t=null==e?void 0:e.querySelector("video");if(!t)throw Error(`No <video> element found inside #${e.id}`);let i=0,a=0;return t.addEventListener("play",()=>{a=0,i=performance.now()}),t.addEventListener("pause",()=>a=0),t.addEventListener("ended",()=>a=0),t.addEventListener("timeupdate",()=>{t.paused||(a=performance.now()-i)}),{shouldFirePixel:()=>a>=2e3}},ig=e=>{let t=e.getBoundingClientRect(),i=iw(t),a=[];for(let[n,r]of i)if(iv(n,r))for(let i of iI(n,r)){if(!(i instanceof HTMLElement))continue;if(i===e||e.contains(i))break;let l=window.getComputedStyle(i);if("none"===l.display||"hidden"===l.visibility||"0"===l.opacity||"none"===l.pointerEvents||.7>parseFloat(l.opacity))continue;let s=l.backgroundColor;if("transparent"!==s&&"rgba(0,0,0,0)"!==s&&""!==s||l.backgroundImage.includes("url")){a.push({x:n-t.left,y:r-t.top});break}}return a.length/i.length},iw=e=>{let t=[];if(eu().isT1())for(let i=0;i<10;i++)for(let a=0;a<10;a++)t.push([e.left+e.width*(a+.5)/10,e.top+e.height*(i+.5)/10]);else if(eu().isT2()||eu().isT3()||eu().isT4()||eu().isT5())for(let i=0;i<10;i++)t.push([e.left+e.width/2,e.top+e.height*(i+.5)/10]);return t},iv=(e,t)=>{let i=window.innerWidth||document.documentElement.clientWidth,a=window.innerHeight||document.documentElement.clientHeight;return e>=0&&e<=i&&t>=0&&t<=a},ib=e=>{let t=e.getBoundingClientRect(),i=window.innerHeight||document.documentElement.clientHeight,a=window.innerWidth||document.documentElement.clientWidth,n={top:Math.max(0,t.top),left:Math.max(0,t.left),bottom:Math.min(i,t.bottom),right:Math.min(a,t.right)};if(t.top>=i||t.left>=a||t.bottom<=0||t.right<=0||t.width<=0||t.height<=0)return 0;let r=(n.right-n.left)*(n.bottom-n.top);return r/(t.width*t.height)},iy=(e,t)=>{let i=Math.max(0,Math.min(e.right,t.right)-Math.max(e.left,t.left)),a=Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top));return 0===i||0===a?0:i*a/(e.width*e.height)},iE=e=>{let{height:t,top:i,left:a=0,width:n=window.innerWidth}=e;return{top:i,bottom:i+t,left:a,right:a+n,width:n,height:t}},iI=(e,t)=>{let i=[];if(eu().isT1()||eu().isT2())i=document.elementsFromPoint(e,t);else if(eu().isT3()||eu().isT4()||eu().isT5()){let a=document.elementFromPoint(e,t);a&&i.push(a)}return i},ix=e=>(null==e?void 0:e.toLowerCase())==="mshop",iP=()=>eu().isT1()||eu().isT2()||eu().isT3()||eu().isT4()||eu().isT5(),iS=e=>{let t=(t,i,a)=>{if(iP()){let n=i-e.getDOMObstructionPercentage(t.div)<a;return e.emitObstructionMetrics(t,n,"DOM"),eu().isT5()&&n}return!1},i=(t,i,a)=>{if(ix(t.deviceType)&&eg().isT1()){let n=i-e.getNativeObstructionPercentage(t.div)<a;return e.emitObstructionMetrics(t,n,"Native"),n}return!1};return{isViewabilityObstructed(e,a){let n=ib(e.div);return t(e,n,a)||i(e,n,a)},emitObstructionRecoveryMetrics(t){e.emitObstructionRecoveryMetrics(t)},removeNativeObstructionsChangedListener(){e.removeNativeObstructionsChangedListener()}}},iT=async e=>new Promise((t,i)=>{if(!P)return void i(Error("mash:getbottombars:missing"));let a=setTimeout(()=>{i(Error("mash:getbottombars:timeout"))},e),n=performance.now();P.when("ConfigChromeFramework").execute(e=>{e.getBottomBarsHeight({successCallback:e=>{clearTimeout(a),t({heightPx:e.visibleHeight,latencyMs:performance.now()-n})},failCallback:()=>{i(Error("mash:getbottombars:failure"))}})})}),iA=async e=>new Promise((t,i)=>{if(!P)return void i(Error("mash:getchromeinfo:missing"));let a=setTimeout(()=>{i(Error("mash:getchromeinfo:timeout"))},e),n=performance.now();P.when("MShopChrome").execute(e=>{e.getChromeInfo({successCallback:e=>{clearTimeout(a),t({heightPx:e.portraitChromeHeight,isOverlapping:e.isTransparentNav,latencyMs:performance.now()-n})},failCallback:()=>{i(Error("mash:getchromeinfo:failure"))}})})}),iC=async e=>new Promise((t,i)=>{if(!P)return void i(Error("mash:getobstructions:missing"));let a=setTimeout(()=>{i(Error("mash:getobstructions:timeout"))},e),n=performance.now();P.when("mash").execute(e=>{var r,l;if(!(null==e||null==(l=e.appCX)||null==(r=l.uiOrchestrator)?void 0:r.getObstructions)){clearTimeout(a),i(Error("mash:getobstructions:missing"));return}e.appCX.uiOrchestrator.getObstructions({successCallback:e=>{clearTimeout(a),t({boundingBoxes:(e.boundingBoxes||[]).map(iE),isFullyObstructed:e.isFullyObstructed,latencyMs:performance.now()-n})},failCallback:()=>{clearTimeout(a),i(Error("mash:getobstructions:failure"))}})})}),iM=e=>{if(!P)return void N("mash:missing",1);P.when("mash").execute(t=>{null==t||t.addEventListener("obstructionsChanged",e)})},ik=e=>{if(!P)return void N("mash:missing",1);P.when("mash").execute(t=>{null==t||t.removeEventListener("obstructionsChanged",e)})},iN=e=>{let t=[],i=!1,a=!1,n=!1,r=new Set,l=e=>{var i;t=((null==e||null==(i=e.detail)?void 0:i.boundingBoxes)||[]).map(iE)},s=e=>e.isFullyObstructed?[iE({height:window.innerHeight,top:0})]:e.boundingBoxes.map(iE),o=async()=>{try{if(t=[],ef().isT1()){n||(iM(l),n=!0);let e=await iC(950);t=s(e);return}let e=await iT(950);c("mash:getbottombars:latency",e.latencyMs),e.heightPx>0&&t.push(iE({height:e.heightPx,top:window.innerHeight-e.heightPx}));let i=await iA(950);c("mash:gettopnav:latency",i.latencyMs),i.isOverlapping&&i.heightPx>0&&t.push(iE({height:i.heightPx,top:0}))}catch(e){c(e.message)}};ix(e)&&eg().isT1()&&o();let d=e=>{if(0===t.length)return 0;let i=e.getBoundingClientRect();return t.reduce((e,t)=>e+iy(i,t),0)},c=(e,t=1,i)=>{r.has(e)||(N(e,t),B(e,t),i&&(k(e,i,t),F(e,i,t)),r.add(e))},m=t=>{(i||a)&&(ix(e)&&a?c("viewPixel:iab:obstruction:recovered",1,t):i&&c("viewPixel:iab:obstruction:recovered:dom",1,t))},h=(e,t,n)=>{c("DOM"===n?"viewPixel:iab:fired":"viewPixel:iab:mshop:fired",1,e),t&&(c("DOM"===n?"viewPixel:iab:obstruction:UXElement":"viewPixel:iab:obstruction:native",1,e),"DOM"===n?i=!0:(c("viewPixel:iab:obstruction:native:y:offset",window.scrollY+e.div.getBoundingClientRect().top,e),a=!0))};return{getNativeObstructionPercentage:e=>d(e),getDOMObstructionPercentage:e=>ig(e),emitObstructionRecoveryMetrics(e){m(e)},emitObstructionMetrics(e,t,i){h(e,t,i)},removeNativeObstructionsChangedListener(){ef().isT1()&&ix(e)&&n&&eg().isT1()&&ik(l)}}},iR=e=>e.btrPixelUrl?new ip(e.btrPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext):void 0,iD=e=>new ia(e.aaxImpPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext),iO=e=>new ir(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext),i_=e=>new il(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext,0,0,"amzn"),iL=(e,t,i,a)=>{let n=iS(iN(a));return"V"===e?iz(t,i,n):iF(a)&&iB(t)?iU(i,n):iV(i,n)},iF=e=>"DESKTOP"===e,iB=e=>iH(e)>=242500,iH=e=>e.getBoundingClientRect().height*e.getBoundingClientRect().width,iz=(e,t,i)=>new il(t.aaxInstrPixelUrl,t.abpAcceptable,t.abpStatus,t.loggingContext,.5,2e3,"iab",[iu(e)],i),iU=(e,t)=>new il(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext,.3,1e3,"iab",[],t),iV=(e,t)=>new il(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext,.5,1e3,"iab",[],t),i$=e=>new il(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext,1,1e3,"groupm"),iW=e=>{if(e.skAdNetwork)return new im(e.aaxImpPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext,e.skAdNetwork)},iJ=e=>{if(e.skAdNetwork)return new ih(e.aaxInstrPixelUrl,e.abpAcceptable,e.abpStatus,e.loggingContext,e.skAdNetwork)},ij=async e=>{var t,i;let a=av(e),n={id:e.placementId,name:e.placementName,div:t5(e)};await (null==(t=iW(a))?void 0:t.fire(n)),null==(i=iJ(a))||i.track(n)},iq=async(e,t,i,a)=>{i.firePixelsAfter&&await tY(i.firePixelsAfter,t5(i)),await t1(i),a.measurementMethod===tG&&e.sendMessageToAd(i.arid,"fireImpression",{measurementMethod:tG,isNoInventory:a.isNoInventory}),ij(i),iG(e,t,i,a.isNoInventory)},iG=(e,t,i,a)=>{a?t4(e,t,i):t9(e,t,i)},iX="gw-video-orchestrator",iY=(e,t,i)=>{var a;null==(a=window.P)||a.when(iX).execute(a=>{try{a.subscribe(e,t,i)}catch(e){c(`gw-video-orchestrator error: ${JSON.stringify(e)}`)}})},iK=e=>iQ(e),iZ=()=>iQ(),iQ=e=>{var t;null==(t=window.P)||t.when(iX).execute(t=>{t.elect(e)})},i0=null,i1=(e,t,i)=>{let a=t=>i.sendCustomMessageToAd(e.arid,"videoAutoplayResponse",t);i3(e.pageType)?iY(t0(e),a,t):i0===e.arid?a(!0):null===i0&&i9(t0(e))?(i0=e.arid,a(!0)):a(!1)},i2=()=>{iZ(),i0=null},i5=e=>{iK(t0(e)),i0=e.arid},i3=e=>(null==e?void 0:e.toLowerCase())==="gateway",i9=e=>![...document.getElementsByTagName("video")].some(t=>!t.paused&&tm(e,t)),i4="btr:impression";var i6=function(e,t){i8()&&i7(e+ae(t))},i8=function(){var e;return"function"==typeof(null==(e=null==window?void 0:window.ue)?void 0:e.tag)},i7=function(e){var t;return null==(t=null==window?void 0:window.ue)?void 0:t.tag(e)},ae=function(e){return e?":".concat(e):""};let at=e=>{if(!(null==e?void 0:e.adCreativeMetaData)||!Object.keys(e.adCreativeMetaData).length){i6("noadrender"),L({adrender:"false"});return}i6("adrender"),i6("adrender:safeframe"),ai(e),an(e),ar(e),al(e)},ai=e=>{let t=aa(e);i6("adrender","creativetemplatename:"+t),L({adrender:"true",creativeTemplateName:t,isLightAds:"false"})},aa=e=>e.adCreativeMetaData.adCreativeTemplateName?e.adCreativeMetaData.adCreativeTemplateName.toLowerCase().replace(/[^0-9a-z]/g,""):"unknown",an=e=>{e.adCreativeMetaData.adCreativeId&&(i6("adrender","creativeid:"+e.adCreativeMetaData.adCreativeId),L({creativeId:e.adCreativeMetaData.adCreativeId}))},ar=e=>{e.adCreativeMetaData.adProgramId&&(i6("adrender","programid:"+e.adCreativeMetaData.adProgramId),L({adProgramId:e.adCreativeMetaData.adProgramId}))},al=e=>{void 0!==e.isCardsFlow&&L({isCardsFlow:e.isCardsFlow.toString()})},as=async e=>{var t;e.firePixelsAfter&&await tY(e.firePixelsAfter,t5(e)),await t1(e),null==(t=iR(av(e)))||t.fire({id:e.placementId,name:e.placementName,div:t5(e)}),ao(e)},ao=e=>{k(i4,{id:e.placementId,name:e.placementName},1),N(i4,1),N(i4+":program:"+(e.adCreativeMetaData.adProgramId?e.adCreativeMetaData.adProgramId:"unknown"),1),N(i4+":template:"+aa(e),1)},ad=(e,t)=>{m(t.message+": "+e.placementName,t.error),m(t.message,t.error)},ac=(e,t)=>{h(t.message+": "+e.placementName,t.error)},am=(e,t)=>{(e.size.width!==t.width||e.size.height!==t.height)&&eQ(e).resize(t)&&tz(e,t)},ah=(e,t)=>F(t.metricName,{name:e.placementName,id:e.placementId}),ap=async(e,i,a,n)=>{let r=t5(e);await tY(e.firePixelsAfter,r),await t1(e);let l=av(e),s={id:e.placementId,name:e.placementName,div:r,deviceType:e.deviceType};if(iO(l).fire(s),t(e.mediaType))t9(i,a,e);else{let{amznViewPixel:t,iabViewPixel:i,groupmViewPixel:a}=au(l,e,s);t.track(s),i.isBtr=n.isBtr,i.track(s),a.track(s)}},au=(e,t,i)=>({amznViewPixel:i_(e),iabViewPixel:iL(t.mediaType,i.div,e,t.deviceType),groupmViewPixel:i$(e)}),ag=new Set;class aw{constructor(e,t){this.hms=e,this.hc=t,this.changeSize=am,this.startBTRPixelTracking=async(e,t)=>{await iq(this.hms,this.hc,e,t)},this.fireImpressionWithDelay=async e=>{await t3(this.hms,e)},this.logAPIInvocation=(e,t)=>{let i=`messenger:${t.apiName}`;N(i),k(i,{id:e.placementId,name:e.placementName})},this.logError=ad,this.logFatal=ac,this.logCsaEvent=ah,this.sendLatencyMetric=(e,t)=>af(e,t),this.fireViewableLatencyMetrics=async(e,t)=>{tZ(this.hc.viewableLatencyTrackers,e.arid,e.placementName,e.placementId,e.adUnitPlacementId,t.adLoadedTimestamp)},this.countMetric=(e,t)=>{t.isGlobal?N(t.metricMsg,t.value):k(t.metricMsg,{id:e.placementId,name:e.placementName},t.value)},this.requestVideoAutoplay=(e,t)=>{N("common:supported:command:requestVideoAutoplay"),i1(e,t,this.hms)},this.releaseVideoAutoplay=()=>{N("common:supported:command:releaseVideoAutoplay"),i2()},this.haveVideoAutoplayPermission=e=>{N("common:supported:command:haveVideoAutoplayPermission"),i5(e)},this.feedbackLabelRendered=e=>{ex(e)},this.feedbackOpenModal=e=>{eP(e)},this.collapseSlot=e=>{eQ(e).collapse(e)},this.sendEventAddedCreative=async e=>{eV("debug:pixel:cod:prededupe",e),ag.has(e.placementId)||(eV("debug:pixel:cod:prehost",e),e.firePixelsAfter&&await tY(e.firePixelsAfter,t5(e)),await t1(e),eV("debug:pixel:cod:host",e),iD(av(e)).fire({id:e.placementId,name:e.placementName,div:t5(e)}),ag.add(e.placementId))},this.sendEventCreativeBeginToRender=as,this.sendEventCreativeLoaded=async(e,t)=>{await ap(e,this.hms,this.hc,t)}}}let af=(e,{latencyMetricType:t,timestamp:i})=>{tP().sendLatencyMetric({latencyMetricType:t,placementName:e.placementName,placementId:e.placementId,placementDivId:e.adUnitPlacementId,timestamp:i})},av=e=>{var t;return{aaxImpPixelUrl:e.aaxImpPixelUrl,aaxInstrPixelUrl:e.aaxInstrPixelUrl,abpAcceptable:e.abpAcceptable,abpStatus:null!=(t=e.abpStatus)?t:"-1",btrPixelUrl:e.btrPixelUrl,skAdNetwork:e.skAdNetwork,loggingContext:{aaxProgramId:Number(e.adCreativeMetaData.adProgramId)}}},ab=()=>({aPageStart:window.aPageStart,adStartTime:new Date().getTime()}),ay="nav-cart",aE=e=>{let t=document.documentElement,i=t5(e);aI(t,i),new MutationObserver(e=>{for(let t of e)"attributes"===t.type&&"class"===t.attributeName&&aI(t.target,i)}).observe(t,{attributes:!0,attributeFilter:["class"]})},aI=(e,t)=>{if(e.classList.contains("nav-ewc-persistent-hover")){t.classList.add(ay);let e=ax();t.style.setProperty("--nav-cart-full-width",`${e}px`),t.style.setProperty("--nav-cart-half-width",`${e/2}px`)}else t.classList.remove(ay)},ax=()=>{var e;let t=document.querySelector("div#nav-flyout-ewc");return null!=(e=null==t?void 0:t.offsetWidth)?e:0},aP=Array.from({length:100},(e,t)=>(t+1)/100),aS=(e,t)=>{let i=t0(e);i&&new IntersectionObserver(i=>i.forEach(i=>aT(e,t,i)),{threshold:aP}).observe(i)},aT=(e,t,{target:i,intersectionRect:a,boundingClientRect:n,intersectionRatio:r})=>{let l=a.width/n.width,s=a.height/n.height;t.sendMessageToAd(e.arid,"populateSafeFrameExt",{geom:{self:{t:n.top,l:n.left,r:n.right,b:n.bottom,xiv:l,yiv:s,iv:r,z:1,w:i.offsetWidth,h:i.offsetHeight}},inViewPercentage:Math.round(100*r)})},aA=(e,t)=>{setInterval(()=>{let i=t0(e);if(!i)return;let a=i.getBoundingClientRect();t.sendMessageToAd(e.arid,"populateGeom",{geom:{self:{t:a.top,l:a.left,r:a.right,b:a.bottom,z:1,w:i.offsetWidth,h:i.offsetHeight}}})},250)},aC=e=>({onSafeFrameReady(t){var i,a;aM("eventsChannel:onSafeFrameReady",t),null==(a=performance)||null==(i=a.mark)||i.call(a,`SafeFrame:  safeFrameReady ${t.slotName}`),e.sendMessageToAd(t.arid,"setupComputedAdDetails",{computed:ab()}),window.addEventListener("resize",()=>{e.sendCustomMessageToAd(t.arid,"resize",{height:window.innerHeight,width:window.innerWidth})}),at(t),aE(t),aS(t,e),aA(t,e)},onPreCreativeWrite(e){aM("eventsChannel:onPreCreativeWrite",e)},onPostCreativeWrite(e){aM("eventsChannel:onPostCreativeWrite",e)},onCreativeBeginToRender(e){aM("eventsChannel:onCreativeBeginToRender",e)},onCreativeLoad(e){aM("eventsChannel:onCreativeLoad",e)},onError(e){aM("eventsChannel:onError",e)}}),aM=(e,t)=>{N(e),k(e,{id:t.placementId,name:t.placementName},performance.now())},ak=()=>{let e=new g,t=new w(e.adMap),i=aC(t),a=new v(new aw(t,e),i);return new tV(e,a)},aN=()=>{performance.mark("Safeframe: initSafeframeHostDesktop"),window.APE_SF||(performance.mark("Safeframe: initSafeframeHostDesktop init"),window.APE_SF=ak())};e(()=>aN(),m,"Error initializing safeFrame")()})();
//# sourceMappingURL=DAsf-1.50.9833c673.js.map
